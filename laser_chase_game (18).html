<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>게임</title>
<style>
body{margin:0;padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background:#1a1a2e;font-family:Arial,sans-serif;color:#eee}
.score-board{display:flex;justify-content:space-around;margin-bottom:20px;font-size:24px;font-weight:bold;width:500px}
.player-score{padding:10px 20px;background:#16213e;border-radius:10px;border:3px solid #0f3460;transition:all .3s}
.player-score.hit{animation:hitEffect .5s}
@keyframes hitEffect{0%{transform:scale(1);background:#16213e}50%{transform:scale(1.1);background:#ff1744}100%{transform:scale(1);background:#16213e}}
.inside{border-color:#00ff88}.outside{border-color:#ff6b6b}
.grid-wrapper{position:relative;display:inline-block}
.laser-container{position:absolute;display:flex}
.laser-container.top{top:-40px;left:0}.laser-container.bottom{bottom:-40px;left:0}
.laser-container.left{left:-40px;top:0;flex-direction:column}.laser-container.right{right:-40px;top:0;flex-direction:column}
.laser-btn{width:100px;height:30px;background:#0f3460;border:2px solid #16213e;margin:0}
.laser-container.left .laser-btn,.laser-container.right .laser-btn{width:30px;height:100px}
.laser-btn.charging{background:#ff9f1c;animation:charge 2s linear}
.laser-btn.firing{background:#ff1744;box-shadow:0 0 20px #ff1744}
@keyframes charge{from{background:#0f3460}to{background:#ff9f1c}}
.laser-beam{position:absolute;background:linear-gradient(90deg,transparent,#ff1744,#ff1744,transparent);opacity:.8;pointer-events:none;z-index:10;transition:opacity .5s ease-out}
.laser-beam.fading{opacity:0}
.laser-beam.vertical{width:100px;height:500px}.laser-beam.horizontal{width:500px;height:100px}
.crossbow{position:absolute;width:20px;height:20px;background:#8b4513;top:240px;left:240px;border-radius:5px;z-index:5}
.arrow{position:absolute;width:15px;height:3px;background:#654321;z-index:8}
.card{position:absolute;width:10px;height:15px;border-radius:2px;z-index:8}
.card.normal{background:#fff}.card.ice{background:#00bfff}.card.power{background:#ff1744}
.special-orb{position:absolute;width:25px;height:25px;background:radial-gradient(circle,#ffd700,#ff8c00);border-radius:50%;box-shadow:0 0 20px #ffd700;animation:pulse 1s infinite;z-index:3}
.grid{display:grid;grid-template-columns:repeat(50,10px);grid-template-rows:repeat(50,10px);gap:0;background:#0f3460;border:3px solid #16213e;position:relative}
.cell{width:10px;height:10px;background:#16213e;position:relative}
.cell.block-border{border:1px solid #00ff88}
.player{position:absolute;width:8px;height:8px;background:#00ff88;border-radius:50%;box-shadow:0 0 10px #00ff88;top:50%;left:50%;transform:translate(-50%,-50%);z-index:5}
.player.stunned{background:#888;box-shadow:0 0 10px #888}
.player.invincible{background:#ffd700;box-shadow:0 0 15px #ffd700;animation:invincibleAnim .5s infinite}
@keyframes invincibleAnim{0%,100%{opacity:1}50%{opacity:.5}}
.item{position:absolute;width:20px;height:20px;background:#ffd700;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 15px #ffd700;animation:pulse 1s infinite;z-index:3}
@keyframes pulse{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.2)}}
.info{margin-top:20px;text-align:center;font-size:16px}
.space-counter{font-size:20px;color:#ffd700;margin-top:10px}
.game-over{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.9);padding:40px;border-radius:20px;text-align:center;font-size:32px;z-index:100;display:none}
.game-over.show{display:block}
.restart-btn{margin-top:20px;padding:15px 30px;font-size:18px;background:#00ff88;border:none;border-radius:10px;cursor:pointer;color:#1a1a2e;font-weight:bold}
.choice-modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.95);padding:40px;border-radius:20px;z-index:200;display:none;flex-direction:column;align-items:center}
.choice-modal.show{display:flex}
.choice-title{font-size:24px;margin-bottom:20px;color:#ffd700}
.choice-buttons{display:flex;gap:15px}
.choice-btn{padding:20px 30px;font-size:20px;background:#16213e;border:2px solid #00ff88;border-radius:10px;color:#eee;cursor:pointer}
</style>
</head>
<body>
<div class="score-board">
<div class="player-score inside"><div>Player 1</div><div id="insideScore">100</div></div>
<div class="player-score outside"><div>Player 2</div><div id="outsideScore">100</div></div>
</div>
<div class="grid-wrapper">
<div class="laser-container top" id="topLasers"></div>
<div class="laser-container bottom" id="bottomLasers"></div>
<div class="laser-container left" id="leftLasers"></div>
<div class="laser-container right" id="rightLasers"></div>
<div class="grid" id="grid"></div>
</div>
<div class="info">
<div id="roleInfo">Player 1: 방향키로 이동 | Player 2: 7=레이저, 8=석궁, 9=카드</div>
<div class="space-counter" id="spaceCounter"></div>
</div>
<div class="game-over" id="gameOver">
<div id="winnerText"></div>
<button class="restart-btn" onclick="location.reload()">다시 시작</button>
</div>
<div class="choice-modal" id="choiceModal">
<div class="choice-title">선택하세요 (무엇인지 모릅니다)</div>
<div class="choice-buttons">
<button class="choice-btn" onclick="selectChoice(0)">1</button>
<button class="choice-btn" onclick="selectChoice(1)">2</button>
<button class="choice-btn" onclick="selectChoice(2)">3</button>
<button class="choice-btn" onclick="selectChoice(3)">4</button>
<button class="choice-btn" onclick="selectChoice(4)">5</button>
</div>
</div>
<script>
const grid=document.getElementById('grid'),insideScoreEl=document.getElementById('insideScore'),outsideScoreEl=document.getElementById('outsideScore'),roleInfoEl=document.getElementById('roleInfo'),spaceCounterEl=document.getElementById('spaceCounter'),gameOverEl=document.getElementById('gameOver'),winnerTextEl=document.getElementById('winnerText');let currentMode='laser',insideScore=100,outsideScore=100,insideDamageTaken=0,outsideDamageTaken=0,isInsidePlayer=!0,playerX=0,playerY=0,isStunned=!1,stunTimeout=null,itemBlockX=null,itemBlockY=null,spaceCount=0,orbSpaceCount=0,laserDirection=null,gameActive=!0,crossbowAngle=0,arrows=[],cards=[],crossbow=null,arrowInterval=null,specialOrb=null,isInvincible=!1,invincibleHits=0,speedMultiplier=1,activeLasers={top:[!1,!1,!1,!1,!1],bottom:[!1,!1,!1,!1,!1],left:[!1,!1,!1,!1,!1],right:[!1,!1,!1,!1,!1]},cells,player;for(let i=0;i<2500;i++){const cell=document.createElement('div');cell.className='cell';const x=i%50,y=Math.floor(i/50);cell.dataset.x=x;cell.dataset.y=y;(x%10===0||y%10===0)&&cell.classList.add('block-border');grid.appendChild(cell)}cells=document.querySelectorAll('.cell');player=document.createElement('div');player.className='player';cells[0].appendChild(player);for(let i=1;i<=5;i++)['top','bottom','left','right'].forEach(dir=>{const btn=document.createElement('div');btn.className='laser-btn';btn.dataset.dir=dir;btn.dataset.index=i-1;document.getElementById(`${dir}Lasers`).appendChild(btn)});function changeMode(mode){currentMode=mode;crossbow&&(crossbow.remove(),crossbow=null);arrowInterval&&(clearInterval(arrowInterval),arrowInterval=null);arrows.forEach(a=>a.element.remove());arrows=[];cards.forEach(c=>c.element.remove());cards=[];if(mode==='laser')document.querySelectorAll('.laser-container').forEach(el=>el.style.display='flex');else if(mode==='crossbow'){document.querySelectorAll('.laser-container').forEach(el=>el.style.display='none');crossbow=document.createElement('div');crossbow.className='crossbow';grid.appendChild(crossbow);arrowInterval=setInterval(shootArrow,1000)}else if(mode==='card')document.querySelectorAll('.laser-container').forEach(el=>el.style.display='none');updateRoleInfo()}function spawnItem(){document.querySelectorAll('.item').forEach(item=>item.remove());let blockX,blockY;do{blockX=Math.floor(Math.random()*5);blockY=Math.floor(Math.random()*5)}while(Math.floor(playerX/10)===blockX&&Math.floor(playerY/10)===blockY);itemBlockX=blockX;itemBlockY=blockY;const startX=blockX*10,startY=blockY*10,cellIndex=startY*50+startX,item=document.createElement('div');item.className='item';cells[cellIndex].appendChild(item)}function spawnSpecialOrb(){if(specialOrb)return;let blockX,blockY;do{blockX=Math.floor(Math.random()*5);blockY=Math.floor(Math.random()*5)}while(Math.floor(playerX/10)===blockX&&Math.floor(playerY/10)===blockY);const startX=blockX*10,startY=blockY*10,cellIndex=startY*50+startX;specialOrb=document.createElement('div');specialOrb.className='special-orb';specialOrb.dataset.blockX=blockX;specialOrb.dataset.blockY=blockY;specialOrb.style.top='50%';specialOrb.style.left='50%';specialOrb.style.transform='translate(-50%, -50%)';cells[cellIndex].appendChild(specialOrb)}function checkOrbCollision(){if(!specialOrb)return!1;const currentBlockX=Math.floor(playerX/10),currentBlockY=Math.floor(playerY/10);return currentBlockX==specialOrb.dataset.blockX&&currentBlockY==specialOrb.dataset.blockY}spawnItem();function updatePlayerPosition(){const cellIndex=playerY*50+playerX;player.remove();cells[cellIndex].appendChild(player)}function checkItemCollision(){const currentBlockX=Math.floor(playerX/10),currentBlockY=Math.floor(playerY/10);return currentBlockX===itemBlockX&&currentBlockY===itemBlockY}function switchRoles(){const wasInsidePlayer=isInsidePlayer;isInsidePlayer=!isInsidePlayer;spaceCount=0;spaceCounterEl.textContent='';wasInsidePlayer?insideScore+=10:outsideScore+=10;updateScores();updateRoleInfo();spawnItem()}function updateRoleInfo(){if(currentMode==='laser')isInsidePlayer?roleInfoEl.textContent='P1: 방향키 이동 | P2: WASD 방향, 1-5 레이저, 7/8/9 모드':roleInfoEl.textContent='P1: WASD 이동 | P2: 방향키 방향, 1-5 레이저, 7/8/9 모드';else if(currentMode==='crossbow')isInsidePlayer?roleInfoEl.textContent='P1: 방향키 이동 | P2: A/D 각도, 1 발사, 7/8/9 모드':roleInfoEl.textContent='P1: WASD 이동 | P2: ←/→ 각도, 1 발사, 7/8/9 모드';else if(currentMode==='card')isInsidePlayer?roleInfoEl.textContent='P1: 방향키 이동 | P2: 1 카드 발사, 7/8/9 모드':roleInfoEl.textContent='P1: WASD 이동 | P2: 1 카드 발사, 7/8/9 모드'}function updateScores(){insideScoreEl.textContent=insideScore;outsideScoreEl.textContent=outsideScore;(insideScore<=0||outsideScore<=0)&&endGame()}function endGame(){gameActive=!1;const winner=insideScore>outsideScore?'Player 1':'Player 2';winnerTextEl.textContent=`${winner} 승리!`;gameOverEl.classList.add('show')}function dealDamage(amount,target){if(target==='inside'){if(isInsidePlayer&&isInvincible){invincibleHits++;invincibleHits>=10&&(isInvincible=!1,speedMultiplier=1,player.classList.remove('invincible'));return}insideScore-=amount;insideDamageTaken+=amount;insideScoreEl.parentElement.classList.add('hit');setTimeout(()=>insideScoreEl.parentElement.classList.remove('hit'),500);console.log('Inside dmg:',insideDamageTaken,'Need: 25, Orb exists:',!!specialOrb);if(insideDamageTaken>=25&&!specialOrb){console.log('CREATING ORB FOR INSIDE');spawnSpecialOrb();insideDamageTaken=0}}else{if(!isInsidePlayer&&isInvincible){invincibleHits++;invincibleHits>=10&&(isInvincible=!1,speedMultiplier=1,player.classList.remove('invincible'));return}outsideScore-=amount;outsideDamageTaken+=amount;outsideScoreEl.parentElement.classList.add('hit');setTimeout(()=>outsideScoreEl.parentElement.classList.remove('hit'),500);console.log('Outside dmg:',outsideDamageTaken,'Need: 25, Orb exists:',!!specialOrb);if(outsideDamageTaken>=25&&!specialOrb){console.log('CREATING ORB FOR OUTSIDE');spawnSpecialOrb();outsideDamageTaken=0}}updateScores()}function fireLaser(direction,blockIndex){const btns=document.querySelectorAll(`.laser-btn[data-dir="${direction}"]`),btn=btns[blockIndex];for(let i=0;i<5;i++)if(activeLasers[direction][i])return;activeLasers[direction][blockIndex]=!0;btn.classList.add('charging');setTimeout(()=>{btn.classList.remove('charging');btn.classList.add('firing');const beam=document.createElement('div');beam.className='laser-beam';let hitPlayer=!1;const playerBlockX=Math.floor(playerX/10),playerBlockY=Math.floor(playerY/10);if(direction==='top'){beam.classList.add('vertical');beam.style.top='0';beam.style.left=blockIndex*100+'px';playerBlockX===blockIndex&&(hitPlayer=!0)}else if(direction==='bottom'){beam.classList.add('vertical');beam.style.bottom='0';beam.style.left=blockIndex*100+'px';playerBlockX===blockIndex&&(hitPlayer=!0)}else if(direction==='left'){beam.classList.add('horizontal');beam.style.left='0';beam.style.top=blockIndex*100+'px';playerBlockY===blockIndex&&(hitPlayer=!0)}else if(direction==='right'){beam.classList.add('horizontal');beam.style.right='0';beam.style.top=blockIndex*100+'px';playerBlockY===blockIndex&&(hitPlayer=!0)}document.querySelector('.grid-wrapper').appendChild(beam);if(specialOrb){const orbBlockX=parseInt(specialOrb.dataset.blockX),orbBlockY=parseInt(specialOrb.dataset.blockY);let hitOrb=!1;((direction==='top'||direction==='bottom')&&orbBlockX===blockIndex||(direction==='left'||direction==='right')&&orbBlockY===blockIndex)&&(hitOrb=!0);hitOrb&&(specialOrb.remove(),specialOrb=null,activateUltimate())}if(hitPlayer&&gameActive){if(!isStunned){isStunned=!0;player.classList.add('stunned');stunTimeout&&clearTimeout(stunTimeout);stunTimeout=setTimeout(()=>{isStunned=!1;player.classList.remove('stunned');stunTimeout=null},3000)}dealDamage(10,isInsidePlayer?'inside':'outside')}setTimeout(()=>{beam.classList.add('fading');setTimeout(()=>{beam.remove();btn.classList.remove('firing');activeLasers[direction][blockIndex]=!1},500)},3000)},2000)}function shootArrow(){if(!gameActive)return;const angle=crossbowAngle*Math.PI/180,arrow={x:250,y:250,vx:Math.cos(angle)*5,vy:Math.sin(angle)*5,element:document.createElement('div')};arrow.element.className='arrow';arrow.element.style.left=arrow.x+'px';arrow.element.style.top=arrow.y+'px';arrow.element.style.transform=`rotate(${crossbowAngle}deg)`;grid.appendChild(arrow.element);arrows.push(arrow)}function manualShootArrow(){const angle=crossbowAngle*Math.PI/180,arrow={x:250,y:250,vx:Math.cos(angle)*5,vy:Math.sin(angle)*5,element:document.createElement('div')};arrow.element.className='arrow';arrow.element.style.left=arrow.x+'px';arrow.element.style.top=arrow.y+'px';arrow.element.style.transform=`rotate(${crossbowAngle}deg)`;grid.appendChild(arrow.element);arrows.push(arrow)}function shootCard(){const types=['normal','ice','power'],type=types[Math.floor(Math.random()*3)],x=Math.random()*480,card={x:x,y:0,vx:(Math.random()-.5)*2,vy:2,type:type,element:document.createElement('div')};card.element.className='card '+type;card.element.style.left=card.x+'px';card.element.style.top=card.y+'px';grid.appendChild(card.element);cards.push(card)}function activateUltimate(){currentMode==='laser'?laserUltimate():currentMode==='crossbow'?crossbowUltimate():currentMode==='card'&&showCardChoice()}function laserUltimate(){const order=[['top',2],['right',2],['bottom',2],['left',2],['top',1],['top',3],['right',1],['right',3],['bottom',1],['bottom',3],['left',1],['left',3],['top',0],['top',4],['right',0],['right',4],['bottom',0],['bottom',4],['left',0],['left',4]];order.forEach((pos,i)=>{setTimeout(()=>{fireLaserUlt(pos[0],pos[1])},i*200)})}function fireLaserUlt(direction,blockIndex){const beam=document.createElement('div');beam.className='laser-beam';let hitPlayer=!1;const playerBlockX=Math.floor(playerX/10),playerBlockY=Math.floor(playerY/10);if(direction==='top'){beam.classList.add('vertical');beam.style.top='0';beam.style.left=blockIndex*100+'px';playerBlockX===blockIndex&&(hitPlayer=!0)}else if(direction==='bottom'){beam.classList.add('vertical');beam.style.bottom='0';beam.style.left=blockIndex*100+'px';playerBlockX===blockIndex&&(hitPlayer=!0)}else if(direction==='left'){beam.classList.add('horizontal');beam.style.left='0';beam.style.top=blockIndex*100+'px';playerBlockY===blockIndex&&(hitPlayer=!0)}else if(direction==='right'){beam.classList.add('horizontal');beam.style.right='0';beam.style.top=blockIndex*100+'px';playerBlockY===blockIndex&&(hitPlayer=!0)}document.querySelector('.grid-wrapper').appendChild(beam);if(hitPlayer&&gameActive){if(!isStunned){isStunned=!0;player.classList.add('stunned');stunTimeout&&clearTimeout(stunTimeout);stunTimeout=setTimeout(()=>{isStunned=!1;player.classList.remove('stunned');stunTimeout=null},3000)}dealDamage(10,isInsidePlayer?'inside':'outside')}setTimeout(()=>{beam.classList.add('fading');setTimeout(()=>{beam.remove()},500)},2000)}function crossbowUltimate(){for(let i=0;i<10;i++)setTimeout(()=>{const arrow={x:250,y:250,vx:(Math.random()-.5)*4,vy:(Math.random()-.5)*4,homing:!0,element:document.createElement('div')};arrow.element.className='arrow';arrow.element.style.left=arrow.x+'px';arrow.element.style.top=arrow.y+'px';arrow.element.style.background='#ff1744';grid.appendChild(arrow.element);arrows.push(arrow)},i*100)}function showCardChoice(){document.getElementById('choiceModal').classList.add('show')}window.selectChoice=function(index){document.getElementById('choiceModal').classList.remove('show');const choices=['laser_ult','crossbow_ult','double_cards','random_death','nothing'],shuffled=choices.sort(()=>Math.random()-.5),selected=shuffled[index];if(selected==='laser_ult')laserUltimate();else if(selected==='crossbow_ult')crossbowUltimate();else if(selected==='double_cards'){const currentCards=[...cards];currentCards.forEach(card=>{const newCard={x:card.x+(Math.random()-.5)*20,y:card.y,vx:card.vx+(Math.random()-.5)*2,vy:card.vy,type:card.type,element:document.createElement('div')};newCard.element.className='card '+card.type;newCard.element.style.left=newCard.x+'px';newCard.element.style.top=newCard.y+'px';grid.appendChild(newCard.element);cards.push(newCard)})}else if(selected==='random_death'){Math.random()<.5?insideScore=0:outsideScore=0;updateScores()}};let pressedKeys={};document.addEventListener('keydown',e=>{if(!gameActive||pressedKeys[e.key])return;pressedKeys[e.key]=!0;const moveKeys=isInsidePlayer?['ArrowUp','ArrowDown','ArrowLeft','ArrowRight']:['w','a','s','d'],dirKeys=isInsidePlayer?['w','a','s','d']:['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'];if(e.key==='7'){changeMode('laser');return}if(e.key==='8'){changeMode('crossbow');return}if(e.key==='9'){changeMode('card');return}if(moveKeys.includes(e.key)){if(isStunned)return;let newX=playerX,newY=playerY;if(isInsidePlayer){if(e.key==='ArrowUp')newY=Math.max(0,playerY-1);if(e.key==='ArrowDown')newY=Math.min(49,playerY+1);if(e.key==='ArrowLeft')newX=Math.max(0,playerX-1);if(e.key==='ArrowRight')newX=Math.min(49,playerX+1)}else{if(e.key==='w')newY=Math.max(0,playerY-1);if(e.key==='s')newY=Math.min(49,playerY+1);if(e.key==='a')newX=Math.max(0,playerX-1);if(e.key==='d')newX=Math.min(49,playerX+1)}playerX=newX;playerY=newY;updatePlayerPosition()}if(currentMode==='laser'){if(dirKeys.includes(e.key)){if(isInsidePlayer){if(e.key==='w')laserDirection='top';if(e.key==='s')laserDirection='bottom';if(e.key==='a')laserDirection='left';if(e.key==='d')laserDirection='right'}else{if(e.key==='ArrowUp')laserDirection='top';if(e.key==='ArrowDown')laserDirection='bottom';if(e.key==='ArrowLeft')laserDirection='left';if(e.key==='ArrowRight')laserDirection='right'}}if(['1','2','3','4','5'].includes(e.key)&&laserDirection){const index=parseInt(e.key)-1;fireLaser(laserDirection,index)}}else if(currentMode==='crossbow'){if(isInsidePlayer){if(e.key==='a')crossbowAngle-=5;if(e.key==='d')crossbowAngle+=5}else{if(e.key==='ArrowLeft')crossbowAngle-=5;if(e.key==='ArrowRight')crossbowAngle+=5}crossbow&&(crossbow.style.transform=`translate(-50%, -50%) rotate(${crossbowAngle}deg)`);e.key==='1'&&manualShootArrow()}else if(currentMode==='card'&&e.key==='1')shootCard();if(e.key===' '){if(checkItemCollision()){spaceCount++;spaceCounterEl.textContent=`스페이스: ${spaceCount}/5`;spaceCount>=5&&switchRoles()}if(checkOrbCollision()){orbSpaceCount++;spaceCounterEl.textContent=`구슬: ${orbSpaceCount}/3`;if(orbSpaceCount>=3){specialOrb.remove();specialOrb=null;orbSpaceCount=0;spaceCounterEl.textContent='';isInvincible=!0;invincibleHits=0;speedMultiplier=2;player.classList.add('invincible')}}}});document.addEventListener('keyup',e=>{delete pressedKeys[e.key]});setInterval(()=>{if(!gameActive)return;isInsidePlayer?insideScore--:outsideScore--;updateScores()},1000);setInterval(()=>{if(!gameActive)return;arrows.forEach((arrow,index)=>{arrow.homing&&function(){const dx=playerX*10+5-arrow.x,dy=playerY*10+5-arrow.y,dist=Math.sqrt(dx*dx+dy*dy);if(dist>0){arrow.vx+=(dx/dist)*.2;arrow.vy+=(dy/dist)*.2;const speed=Math.sqrt(arrow.vx*arrow.vx+arrow.vy*arrow.vy);speed>4&&(arrow.vx=(arrow.vx/speed)*4,arrow.vy=(arrow.vy/speed)*4)}}();arrow.x+=arrow.vx;arrow.y+=arrow.vy;if(arrow.x<0||arrow.x>500||arrow.y<0||arrow.y>500){arrow.element.remove();arrows.splice(index,1);return}arrow.element.style.left=arrow.x+'px';arrow.element.style.top=arrow.y+'px';if(specialOrb){const orbX=parseInt(specialOrb.dataset.blockX)*100+50,orbY=parseInt(specialOrb.dataset.blockY)*100+50;if(Math.abs(arrow.x-orbX)<20&&Math.abs(arrow.y-orbY)<20){specialOrb.remove();specialOrb=null;arrow.element.remove();arrows.splice(index,1);activateUltimate();return}}const cellX=playerX*10+5,cellY=playerY*10+5;if(Math.abs(arrow.x-cellX)<8&&Math.abs(arrow.y-cellY)<8){dealDamage(5,isInsidePlayer?'inside':'outside');arrow.element.remove();arrows.splice(index,1)}});cards.forEach((card,index)=>{card.x+=card.vx;card.y+=card.vy;if(card.x<0||card.x>490){card.vx=-card.vx;card.x=Math.max(0,Math.min(490,card.x))}if(card.y<0||card.y>485){card.vy=-card.vy;card.y=Math.max(0,Math.min(485,card.y))}card.element.style.left=card.x+'px';card.element.style.top=card.y+'px';if(specialOrb){const orbX=parseInt(specialOrb.dataset.blockX)*100+50,orbY=parseInt(specialOrb.dataset.blockY)*100+50;if(Math.abs(card.x-orbX)<20&&Math.abs(card.y-orbY)<20){specialOrb.remove();specialOrb=null;card.element.remove();cards.splice(index,1);activateUltimate();return}}const cellX=playerX*10+5,cellY=playerY*10+5;if(Math.abs(card.x-cellX)<10&&Math.abs(card.y-cellY)<10){if(card.type==='normal')dealDamage(1,isInsidePlayer?'inside':'outside');else if(card.type==='ice'){dealDamage(1,isInsidePlayer?'inside':'outside');if(!isStunned){isStunned=!0;player.classList.add('stunned');setTimeout(()=>{isStunned=!1;player.classList.remove('stunned')},1000)}}else if(card.type==='power')dealDamage(3,isInsidePlayer?'inside':'outside');card.element.remove();cards.splice(index,1)}})},16);
</script>
</body>
</html>